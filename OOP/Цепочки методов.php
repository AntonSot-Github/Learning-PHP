<?php

/* 
ะฆะตะฟะพัะบะฐ ะผะตัะพะดะพะฒ (Method Chaining) ะฒ PHP
ะฆะตะฟะพัะบะฐ ะผะตัะพะดะพะฒ โ ััะพ ัะฟะพัะพะฑ ะฒัะทัะฒะฐัั ะฝะตัะบะพะปัะบะพ ะผะตัะพะดะพะฒ ะพะฑัะตะบัะฐ ะฟะพัะปะตะดะพะฒะฐัะตะปัะฝะพ ะฒ ะพะดะฝะพะน ัััะพะบะต. 
ะญัะพ ะฒะพะทะผะพะถะฝะพ, ะตัะปะธ ะบะฐะถะดัะน ะผะตัะพะด ะฒะพะทะฒัะฐัะฐะตั $this (ัะตะบััะธะน ะพะฑัะตะบั) ะฒะผะตััะพ void ะธะปะธ ะดััะณะธั ะทะฝะฐัะตะฝะธะน.

ะะฐัะตะผ ััะพ ะฝัะถะฝะพ? 
โ ะะตะปะฐะตั ะบะพะด ะฑะพะปะตะต ัะธัะฐะตะผัะผ
โ ะฃะฟัะพัะฐะตั ัะฐะฑะพัั ั ะพะฑัะตะบัะฐะผะธ
โ ะฃะผะตะฝััะฐะตั ะบะพะปะธัะตััะฒะพ ะฟะตัะตะผะตะฝะฝัั
 */

// ะัะธะผะตั 1: ะะฐะฑะพัะฐ ั ัะตััะตัะฐะผะธ
// ะะพะฟัััะธะผ, ั ะฝะฐั ะตััั ะบะปะฐัั User, ะฒ ะบะพัะพัะพะผ ะผะตัะพะดั ะฒะพะทะฒัะฐัะฐัั $this, ะฟะพะทะฒะพะปัั ะฒัะทัะฒะฐัั ะธั ะฒ ัะตะฟะพัะบะต.

class User 
{
    private string $name;
    private int $age;

    public function setName(string $name): self
    {
        $this->name = $name;
        return $this; // ะะพะทะฒัะฐัะฐะตะผ ัะตะบััะธะน ะพะฑัะตะบั
    }

    public function setAge(int $age): self
    {
        $this->age = $age;
        return $this; // ะะพะทะฒัะฐัะฐะตะผ ัะตะบััะธะน ะพะฑัะตะบั
    }

    public function getInfo(): string
    {
        return "ะะผั: {$this->name}, ะะพะทัะฐัั: {$this->age}";
    }
}

$user = (new User())->setName('ะะปะตะบัะตะน')->setAge(30);
echo $user->getInfo() . PHP_EOL; // ะัะฒะตะดะตั: "ะะผั: ะะปะตะบัะตะน, ะะพะทัะฐัั: 30"

// ะัะธะผะตั 2: ะคะพัะผะธัะพะฒะฐะฝะธะต SQL-ะทะฐะฟัะพัะพะฒ
// ะะพะฟัััะธะผ, ั ะฝะฐั ะตััั ะบะปะฐัั QueryBuilder, ะบะพัะพััะน ะฟะพะทะฒะพะปัะตั ัััะพะธัั SQL-ะทะฐะฟัะพัั ะผะตัะพะดะพะผ ัะตะฟะพัะบะธ.

class QueryBuilder 
{
    private string $query = '';

    public function select(string $fields): self
    {
        $this->query .= "SELECT $fields ";
        return $this;
    }

    public function from(string $table): self
    {
        $this->query .= "FROM $table ";
        return $this;
    }

    public function where(string $condition): self
    {
        $this->query .= "WHERE $condition ";
        return $this;
    }

    public function getQuery(): string
    {
        return trim($this->query) . ';';
    }
}

$query = (new QueryBuilder())
    ->select('*')
    ->from('users')
    ->where('age > 18');

echo $query->getQuery() . PHP_EOL; 
// ะัะฒะตะดะตั: "SELECT * FROM users WHERE age > 18;"

/* 
ะัะฒะพะด
๐ ะฆะตะฟะพัะบะฐ ะผะตัะพะดะพะฒ ะฟะพะทะฒะพะปัะตั ะฒัะทัะฒะฐัั ะฝะตัะบะพะปัะบะพ ะผะตัะพะดะพะฒ ะฒ ะพะดะฝะพะน ัััะพะบะต.
๐ ะะฑัะทะฐัะตะปัะฝะพะต ััะปะพะฒะธะต โ ะบะฐะถะดัะน ะผะตัะพะด (ะบัะพะผะต ะฟะพัะปะตะดะฝะตะณะพ) ะดะพะปะถะตะฝ ะฒะพะทะฒัะฐัะฐัั $this.
๐ ะงะฐััะพ ะธัะฟะพะปัะทัะตััั ะฒ ัะตััะตัะฐั, ORM (Eloquent, Doctrine), QueryBuilder ะธ ะดััะณะธั ััะตะนะผะฒะพัะบะฐั. 
*/
